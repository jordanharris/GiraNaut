$(function(){function a(a){var b=$("<div class='guideChatBox' data-id="+a.from+"></div>");$("#chatMessenger").append(b),b.html(d(a))}function b(a){a.timestamp=moment(a.timestamp).format("MMM D, h:mm a"),$(".guideChatBox[data-id="+a.from+"]").find(".chat").append(f(a))}var c=$("#guideChatMessenger").html(),d=Handlebars.compile(c),e=$("#incomingMessage").html(),f=Handlebars.compile(e),g=$("#outgoingMessage").html(),h=Handlebars.compile(g),i=[],j=messageData.filter(function(a){return a});j.sort(function(a,b){return a.date>b.date?1:a.date<b.date?-1:0});var k=messageData.filter(function(a){return a.loggedIn===!1});$("#menu-toggle").click(function(a){a.preventDefault(),$("#wrapper").toggleClass("active")}),$(document).on("click",".guideChatButton",function(){var b=$(this);$.get("/userDoc",function(c){var d={name:b.closest(".guideInnerCard").find("h2").text(),image:b.closest(".guideInnerCard").find("img").attr("src"),from:b.attr("data-id"),userData:c,to:c._id};i.length>0?-1!==i.indexOf(d.from)?$(".guideChatBox[data-id="+d.from+"]").show():-1===i.indexOf(d.from)&&$(".guideChatBox").length<Math.floor($(window).innerWidth()/$(".guideChatBox").innerWidth())?($("#chatMessenger").css("display","block"),a(d),i.push(d.from)):-1===i.indexOf(d.from)&&$(".guideChatBox").length>=Math.floor($(window).innerWidth()/$(".guideChatBox").innerWidth()):$(".guideChatBox").length<Math.floor($(window).innerWidth()/$(".guideChatBox").innerWidth())&&($("#chatMessenger").css("display","block"),a(d),i.push(d.from))})}),$(document).on("click",".panel-heading",function(){"none"===$(this).next().css("display")?($(this).next().css("display","block"),$(this).next().next().css("display","block")):($(this).next().css("display","none"),$(this).next().next().css("display","none"))}),$(document).on("click",".chevronButton",function(){"none"===$(this).closest(".panel-heading").next().css("display")?($(this).closest(".panel-heading").next().css("display","block"),$(this).closest(".panel-heading").next().next().css("display","block")):($(this).closest(".panel-heading").next().css("display","none"),$(this).closest(".panel-heading").next().next().css("display","none"))}),$(document).on("click",".removeButton",function(){{var a=$(this).closest(".guideChatBox");a.attr("data-id")}a.hide()});var l=io.connect("http://premarchmadness.herokuapp.com/");l.on("connect",function(){setInterval(function(){l.emit("noop")},8e3)}),l.on("message",function(c){$(".guideChatBox[data-id="+c.from+"]").length<1?($("#chatMessenger").css("display","block"),a(c),b(c),$(".chatBody").scrollTop($(".chat").height()),i.push(c.from)):(b(c),$(".chatBody").scrollTop($(".chat").height()),i.push(c.from))}),$(document).on("keyup",".messageBox",function(a){if(13===a.keyCode){var b=$(this).closest(".guideChatBox").attr("data-id"),c=guidesData.filter(function(a){return a._id===b}),d=$(this).val(),e=(c[0].firstName,c[0].picture,moment().format("MMM D, h:mm a YYYY"));l.emit("message",{message:d,timestamp:e,name:touristData.name,from:touristData._id,image:touristData.picture,to:c[0]._id}),$(this).closest(".chatWindow").find(".chat").append(h({timestamp:moment(e).format("MMM D, h:mm a"),name:touristData.firstName,message:d,image:touristData.picture})),$(".chatBody").scrollTop($(".chat").height()),d=$(this).val("")}}),$(document).on("click",".btn-chat",function(){var a=$(this).closest(".guideChatBox").attr("data-id"),b=guidesData.filter(function(b){return b._id===a}),c=$(this).closest(".chatWindow").find(".messageBox").val(),d=(b[0].firstName,b[0].picture,moment().format("MMM D, h:mm a YYYY"));l.emit("message",{message:c,timestamp:d,name:touristData.name,from:touristData._id,image:touristData.picture,to:b[0]._id}),$(this).closest(".chatWindow").find(".chat").append(h({timestamp:moment(d).format("MMM D, h:mm a"),name:touristData.firstName,message:c,image:touristData.picture})),$(".chatBody").scrollTop($(".chat").height()),c=$(this).closest(".chatWindow").find(".messageBox").val("")});for(var m=0;m<k.length;m++)$(".guideChatBox[data-id="+k[m].from._id+"]").length<1?($("#chatMessenger").css("display","block"),a({name:k[m].from.name,to:k[m].to,from:k[m].from._id}),b({timestamp:k[m].time,from:k[m].from._id,message:k[m].message,image:k[m].from.picture,name:k[m].from.firstName}),$(".chatBody").scrollTop($(".chat").height()),i.push(k[m].from._id)):(b({timestamp:k[m].time,from:k[m].from._id,message:k[m].message,image:k[m].from.picture,name:k[m].from.firstName}),$(".chatBody").scrollTop($(".chat").height()),i.push(k[m].from._id))});
//# sourceMappingURL=gmapsFunctionality.min.map